System.register(["./index-legacy-a07f5357-1754566720969-2.js","./http-legacy-5140aa35-1754566720969-2.js","./index-legacy-3446a0b7-1754566720969-2.js","./Form-legacy-5d343e67-1754566720969-2.js","./index-legacy-28baaaa7-1754566720969-2.js","./index-legacy-c00bf4ae-1754566720969-2.js","./Input-legacy-c2a44e9a-1754566720969-2.js"],(function(e,a){"use strict";var t,r,l,o,s,d,n,u,i,c,m,p,f,b,g,h,v,D,N,y,q,S,_,x,P,U,I,V=document.createElement("style");return V.textContent=".batch-error-msg[data-v-4765d339]{height:40px;padding:4px 12px;border-radius:4px;margin:10px 0 16px}[data-v-4765d339] .iflorens-picker{width:100%}[data-v-4765d339] .iflorens-col{padding:0}[data-v-4765d339] .iflorens-col label{height:22px;margin-bottom:4px}\n",document.head.appendChild(V),{setters:[e=>{t=e.d,r=e.s,l=e.r,o=e.b3,s=e.k,d=e.am,n=e.w,u=e.o,i=e.l,c=e.n,m=e.u,p=e.i,f=e._,b=e.bV,g=e.e,h=e.f,v=e.bH,D=e.S,N=e.bG},e=>{y=e.f},e=>{q=e._},e=>{S=e._,_=e.F},e=>{x=e._,P=e.a},e=>{U=e.S},e=>{I=e.I}],execute:function(){function a(e={}){return y({url:"/iflorens-contract/api/v0/lease-contract/get-lease-contracts-bylp",method:"post",data:e})}function V(e={}){return y({url:"/iflorens-order/api/lp/save",method:"post",data:e})}function j(e={}){return y({url:"/iflorens-order/api/lp/source/edit",method:"post",data:e})}e({a:function(e={}){return y({url:"/iflorens-order/api/lp/query-conditions-source",method:"post",data:e})},b:function(e={}){return y({url:"/iflorens-order/api/lp/check-to-detail",method:"post",data:e})},c:function(e={}){return y({url:"/iflorens-order/api/lp/query-unit",method:"post",data:e})},d:function(e={}){return y({url:"/iflorens-order/api/lp/query-detail",method:"post",data:e})},f:function(e={}){return y({url:"/iflorens-order/api/lp/is-closed-confirm",method:"post",data:e})},g:function(e={}){return y({url:"/iflorens-order/api/lp/delete-confirm-flag",method:"post",data:e})},h:function(e={}){return y({url:"/iflorens-order/api/lp/excel-upload-operate-confirm",method:"post",data:e})},i:function(e={}){return y({url:"/iflorens-order/api/lp/batch-upload-operate-confirm",method:"post",data:e})},j:function(e={}){return y({url:"/iflorens-file/file/uploadFile?policyKey=lp_upload",method:"post",data:e})},k:function(e={}){return y({url:"/iflorens-order/api/lp/query-order",method:"post",data:e})},l:function(e={}){return y({url:"/iflorens-order/api/lp/export-order",method:"post",data:e})},m:a,p:function(e={}){return y({url:"/iflorens-order/api/lp/page-operate-confirm",method:"post",data:e})},q:function(e={fieldName:"BU"}){return y({url:"/iflorens-mdm/api/v0/psxlatitem/common-select",method:"get",params:e})},s:function(e={}){return y({url:"/iflorens-order/api/lp/query-order-list",method:"post",data:e})},u:function(e={}){return y({url:"/iflorens-order/api/lp/update-unit",method:"post",data:e})}});const w=t({__name:"add-modal",props:{open:{type:Boolean,default:!1},title:{type:String,default:"Add New Lease Purchase"},type:{type:String,default:"add"},basicData:{type:Object,default:()=>({})}},emits:["update:open","refreshBasicData"],setup(e,{emit:t}){const f=r(),y=l("YYYY-MM-DD"),w=e,C=t,O=l(!1),k=l({label:"contractNum",value:"contractNum"}),F=l({label:"addressSeqNum",value:"addressSeqNum"}),R=l([{title:"Contract No",dataIndex:"contractNum"}]),B=l([{title:"Location",dataIndex:"addressSeqNum"},{title:"Description",dataIndex:"addressSeqNumDesc"}]),T=l({totalRecord:"totalRecord",currentPage:"currentPage",pageSize:"pageSize",searchValue:"contractNum",responseData:"data",pageIndex:"pageNo"}),z=l({pageNo:1,pageSize:20}),Y=l({effdt:o().format(y.value),...z.value}),A=l(),L=l(""),M=e=>{const a=o();return e&&e>a},$=s({get:()=>w.open,set:e=>(C("update:open",e),e)}),K=()=>{$.value=!1,L.value="",A.value.resetFields(),C("update:open",!1)},E=d({contractNum:"",addressSeqNum:"",businessUnit:"",asofDt:o(),custId:"",declarationDt:o(),dvOfhPolicy:"",dvPymtTerms:"",onhireDt:""}),G=()=>{if(w.basicData.editFlag>0)return void K();const{asofDt:e,declarationDt:a,contractNum:t,businessUnit:r}=E;A.value.validate().then((()=>{O.value=!0;const l={...E,asofDt:o(e).format(y.value),declarationDt:o(a).format(y.value)};"edit"===w.type&&(l.id=w.basicData.id),("edit"===w.type?j:V)(l).then((e=>{if(0===e.code){if("edit"===w.type)return C("refreshBasicData"),void K();const a=e.data?.lpOrderRef||"";L.value="",f.push(`/leasePurchasedDetail?contractNo=${t}&businessUnit=${r}&DeclareRefNo=${a}`),K()}else L.value=e.msg}))})).catch().finally((()=>{setTimeout((()=>{O.value=!1}),300)}))},H=()=>{A.value.validate("declarationDt")},J=l({contractNum:[{required:!0,message:"Please complete",trigger:"blur"}],addressSeqNum:[{required:!0,message:"Please complete",trigger:"blur"}],businessUnit:[{required:!0,message:"Please complete",trigger:"blur"}],asofDt:[{required:!0,message:"Please complete",trigger:"blur"}],custId:[{required:!0,message:"Please complete",trigger:"blur"}],declarationDt:[{required:!0,trigger:["change","blur"],validator:(e,a)=>a?a&&o(a).format(y.value)>o(E.asofDt).format(y.value)?Promise.reject("Declaration Date must be less than or equal to As Of Date"):Promise.resolve():Promise.reject("Please complete")}]}),Q=e=>{z.value.pageNo=e},W=l([]),X=e=>{const{custId:t,businessUnit:r,addressSeqNum:l,dvOfhPolicy:o,dvPymtTerms:s,contractNum:d}=e;E.contractNum=d,E.businessUnit=r,E.custId=t,E.addressSeqNum=l,E.dvOfhPolicy=o,E.dvPymtTerms=s,a({...Y.value,contractNum:E.contractNum}).then((e=>{const a=[...new Map(e.data.map((e=>[e.addressSeqNum,e]))).values()];W.value=a||[]})).catch((()=>{W.value=[]}))};return n($,(e=>{if(e&&"edit"===w.type){const{contractNum:e,addressSeqNum:a,businessUnit:t,asofDt:r,custId:l,declarationDt:s}=w.basicData;Object.assign(E,{contractNum:e,addressSeqNum:a,businessUnit:t,asofDt:o(r,y.value),custId:l,declarationDt:o(s,y.value)})}})),(t,r)=>{const l=q,o=v,s=S,d=x,n=D,f=U,V=N,j=I,w=P,C=_,z=b;return u(),i(z,{title:e.title,onOk:G,width:"600px","confirm-loading":m(O),open:m($),"onUpdate:open":r[7]||(r[7]=e=>p($)?$.value=e:null),okText:"Confirm",onCancel:K},{default:c((()=>[m(L)?(u(),i(l,{key:0,type:"error","show-icon":"",message:m(L),closable:"",onClose:r[0]||(r[0]=e=>L.value=""),class:"batch-error-msg"},null,8,["message"])):g("v-if",!0),h(C,{model:m(E),ref_key:"formRef",ref:A,rules:m(J),"label-col":{span:24},"wrapper-col":{span:24},autocomplete:"off",layout:"vertical"},{default:c((()=>[h(w,{gutter:[16,0]},{default:c((()=>[h(d,{span:12},{default:c((()=>[h(s,{label:"Contract No.",name:"contractNum"},{default:c((()=>[h(o,{modelValue:m(E).contractNum,"onUpdate:modelValue":r[1]||(r[1]=e=>m(E).contractNum=e),columns:m(R),primaryKey:"contractNum",onPageChange:Q,request:m(a),param:m(Y),customeRender:"",isShowItemRecord:"",disabled:"edit"===e.type,selectStyle:"width: 100%",showSearch:"",fieldNames:m(k),props:m(T),onSelect:X},null,8,["modelValue","columns","request","param","disabled","fieldNames","props"])])),_:1})])),_:1}),h(d,{span:12},{default:c((()=>[h(s,{label:"Location",name:"addressSeqNum"},{default:c((()=>[h(n,{modelValue:m(E).addressSeqNum,"onUpdate:modelValue":r[2]||(r[2]=e=>m(E).addressSeqNum=e),columns:m(B),fieldNames:m(F),options:m(W),customeRender:"",selectStyle:"width: 100%",disabled:e.basicData.editFlag>0},null,8,["modelValue","columns","fieldNames","options","disabled"])])),_:1})])),_:1}),h(d,{span:12},{default:c((()=>[h(s,{label:"Business Unit",name:"businessUnit"},{default:c((()=>[h(f,{value:m(E).businessUnit,"onUpdate:value":r[3]||(r[3]=e=>m(E).businessUnit=e),disabled:""},null,8,["value"])])),_:1})])),_:1}),h(d,{span:12},{default:c((()=>[h(s,{label:"As Of Date",name:"asofDt"},{default:c((()=>[h(V,{modelValue:m(E).asofDt,"onUpdate:modelValue":r[4]||(r[4]=e=>m(E).asofDt=e),disabled:e.basicData.editFlag>0,format:m(y),"disabled-date":M,onBlur:H},null,8,["modelValue","disabled","format"])])),_:1})])),_:1}),h(d,{span:12},{default:c((()=>[h(s,{label:"Customer ID",name:"custId"},{default:c((()=>[h(j,{value:m(E).custId,"onUpdate:value":r[5]||(r[5]=e=>m(E).custId=e),size:"small",disabled:""},null,8,["value"])])),_:1})])),_:1}),h(d,{span:12},{default:c((()=>[h(s,{label:"Declaration Date",name:"declarationDt"},{default:c((()=>[h(V,{modelValue:m(E).declarationDt,"onUpdate:modelValue":r[6]||(r[6]=e=>m(E).declarationDt=e),disabled:e.basicData.editFlag>0,format:m(y),"disabled-date":M},null,8,["modelValue","disabled","format"])])),_:1})])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","confirm-loading","open"])}}});e("e",f(w,[["__scopeId","data-v-4765d339"]]))}}}));

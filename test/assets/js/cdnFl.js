// (c) 2024 zyhy 2024/9/23 13:43:10
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("axios")):"function"==typeof define&&define.amd?define(["axios"],t):(e=e||self).cdnFl=t(e.axios)}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function n(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var a=function(){return n((function e(){t(this,e)}),[{key:"getRelWindow",value:function(){return window.microApp||window.rawWindow||window}},{key:"microToHref",value:function(e){if(e)return this.getRelWindow().location.href=e}},{key:"fileExtension",value:function(e){var t=e.lastIndexOf(".");return e.substr(t+1).toLowerCase()}},{key:"handlePicture",value:function(e){var t="";switch(this.fileExtension(e)){case"doc":case"docx":t="word.svg";break;case"xlsx":case"xls":t="excel.svg";break;case"png":case"jpg":case"svg":t="image.svg";break;case"pdf":t="pdf.svg";break;case"rar":case"zip":case"arj":case"z":case"jar":case"lzh":t="zip.svg";break;case"ppt":case"pptx":t="ppt.svg";break;case"txt":t="otherfile.svg";break;case"eml":case"msg":t="email.svg";break;default:t="unknownfile.svg"}return require("@/assets/crm/"+t)}},{key:"hasLetter",value:function(e){if(!e)return!1;for(var t in e){var o=e.charCodeAt(t);if(o>=65&&o<=90||o>=97&&o<=122)return!0}return!1}},{key:"detectZoom",value:function(){var e=0,t=window.screen,o=navigator.userAgent.toLowerCase();return void 0!==window.devicePixelRatio?e=window.devicePixelRatio:~o.indexOf("msie")?t.deviceXDPI&&t.logicalXDPI&&(e=t.deviceXDPI/t.logicalXDPI):void 0!==window.outerWidth&&void 0!==window.innerWidth&&(e=window.outerWidth/window.innerWidth),e&&(e=Math.round(100*e)),e}},{key:"getZoom",value:function(){return 1/((document.documentElement.clientWidth||document.body.clientWidth)/window.screen.width)}},{key:"uuid",value:function(){for(var e=[],t="0123456789abcdef",o=0;o<36;o++)e[o]=t.substr(Math.floor(16*Math.random()),1);return e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-",e.join("")}},{key:"filePerview",value:function(e,t,o,n){if(n&&n.fileUrl&&!n.fileUrl.includes("/os-public/"))return preview("lease_contract_upload",n.fileUrl,n.fileName),!1;var r=require("js-base64").Base64,i="".concat(e||"https://iflorensdmzuat.florens.com"),a="".concat(i,"/os-public/api/v0/file?bucket=").concat(t,"&fullFileName=").concat(o);window.open("".concat(i,"/preview/onlinePreview?url=").concat(encodeURIComponent(r.encode(a)),"&gengxin=ok&hd=true"))}},{key:"analysisFile",value:function(e){return new Promise((function(t,o){var n=new FileReader;n.onload=function(e){var o=e.target.result,n=XLSX.read(o,{type:"binary"}),r=[];n.SheetNames.forEach((function(e){r.push({sheetName:e,sheet:XLSX.utils.sheet_to_json(n.Sheets[e])})})),t(r)},n.readAsBinaryString(e.file)}))}},{key:"envjudge",value:function(){var e=window.navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),t=/micromessenger/i.test(navigator.userAgent),o=/wxwork/i.test(navigator.userAgent);return o&&e?"com-wx-mobile":o&&!e?"com-wx-pc":t&&e?"wx-mobile":t&&!e?"wx-pc":"other"}},{key:"isMobile",value:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},{key:"toLine",value:function(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}},{key:"parseMergeCell",value:function(e,t,o){for(var n=[],r="",i=1,a=function(){var a=e[s][t];if(r===a?i++:(r=a,i=1),i>1)for(var c=s-i+1,u=function(e){var t=n.find((function(t){return t.row===c&&t.col===o[e]}));t?t.rowspan=i:n.push({row:c,col:o[e],rowspan:i,colspan:1})},l=0;l<o.length;l++)u(l)},s=0;s<e.length;s++)a();return n}},{key:"getCookie",value:function(e){for(var t=e+"=",o=document.cookie.split(";"),n=0;n<o.length;n++){for(var r=o[n];" "==r.charAt(0);)r=r.substring(1);if(-1!=r.indexOf(t))return r.substring(t.length,r.length)}return""}},{key:"setCookie",value:function(e,t,o){var n=new Date;n.setTime(n.getTime()+1e3*o);var r="expires="+n.toUTCString();document.cookie=e+"="+t+"; "+r+";path=/"}},{key:"deleteCookie",value:function(e){var t=new Date;t.setTime(t.getTime()-864e5);var o="expires="+t.toUTCString();document.cookie=e+"=''; "+o+";path=/"}}])}(),s=new a,c=s.getRelWindow,u=s.microToHref,l=s.handlePicture,f=s.hasLetter,d=s.detectZoom,p=s.getZoom,v=s.uuid,g=s.filePerview,m=s.analysisFile,w=s.envjudge,h=s.isMobile,y=s.toLine,b=s.parseMergeCell,k=s.getCookie,S=s.setCookie,x=s.deleteCookie,j=function(){return n((function o(n,r){t(this,o),this.axiosOptions=n,this.Options=r,this.axiosService=e.create(this.axiosOptions),this.interceptors()}),[{key:"defaultOption",value:function(){return{baseURL:"",timeout:1e4,headers:{"Content-Type":"application/json;charset=UTF-8"}}}},{key:"interceptors",value:function(){var e=this;this.axiosService.interceptors.request.use((function(t){if(e.Options&&e.Options.dynamicHeader&&"function"==typeof e.Options.dynamicHeader){var o={};try{o=e.Options.dynamicHeader(t)}catch(e){}Object.assign(t.headers,o);var n=t.headers||{};t.headers=Object.assign(n,o)}return e.callFun(e.Options.succesRequest,t,e.Options),t}),(function(t){return e.callFun(e.Options.errorRequest,t),Promise.reject(t)})),this.axiosService.interceptors.response.use((function(t){return e.callFun(e.Options.succesResponse,t),Promise.resolve(t.data)}),(function(t){return e.callFun(e.Options.errorResponse,t),Promise.reject(t)}))}},{key:"callFun",value:function(e,t,o){if("function"==typeof e)return e(t,o)}}])}(),O=function(e,t,o){switch(e){case"get":return localStorage.getItem(t+"_obj")?JSON.parse(localStorage.getItem(t+"_obj")):localStorage.getItem(t+"_str")?localStorage.getItem(t+"_str"):null;case"set":return O("clean",t),"object"===i(o)?localStorage.setItem(t+"_obj",JSON.stringify(o)):localStorage.setItem(t+"_str",o),!0;case"clean":return localStorage.removeItem(t+"_obj"),localStorage.removeItem(t+"_str"),!0}},P=function(e,t,o){switch(e){case"get":return sessionStorage.getItem(t+"_obj")?JSON.parse(sessionStorage.getItem(t+"_obj")):sessionStorage.getItem(t+"_str")?sessionStorage.getItem(t+"_str"):null;case"set":return P("clean",t),"object"===i(o)?sessionStorage.setItem(t+"_obj",JSON.stringify(o)):sessionStorage.setItem(t+"_str",o),!0;case"clean":return sessionStorage.removeItem(t+"_obj"),sessionStorage.removeItem(t+"_str"),!0}},I=n((function e(){t(this,e)}));return I.getRelWindow=c,I.microToHref=u,I.handlePicture=l,I.flFetch=j,I.localData=O,I.sessionData=P,I.hasLetter=f,I.detectZoom=d,I.getZoom=p,I.uuid=v,I.filePerview=g,I.analysisFile=m,I.envjudge=w,I.isMobile=h,I.toLine=y,I.parseMergeCell=b,I.getCookie=k,I.setCookie=S,I.deleteCookie=x,I}));
